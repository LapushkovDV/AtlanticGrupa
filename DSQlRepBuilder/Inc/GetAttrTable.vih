//------------------------------------------------------------------------------
//                                                      (c) корпорация Галактика
// Версия      : 8.10
// Начиная с версии 7.12  есть возможность в атрибутах типа ссылка прописать любую таблицу для выбора
// не являющуюся аналитикой.
// Количество интерфейсов не ограничено. Предназначен для выпуска патчей и сторонних разработчиков.
// Для этого служат объекты ObjGetAttrTable и ObjGetAttrTablePlugin
//------------------------------------------------------------------------------

#ifdef ComponentVersion
#component "C_ExtClass"
#end

#ifndef _ObjGetAttrTable_Func
#define _ObjGetAttrTable_Func

#doc
ObjGetAttrTable - предоставляет доступ к функциям создания атрибутов
#end
ObjInterface ObjGetAttrTable;
  #doc
  Добавить таблицу
  #end
  Procedure AddTable (_coTable : word);
end;

VipInterface GetAttrTable implements ObjGetAttrTable Licensed(Free)
  Parameters (_SysNum : word; _code : word; _coTable : word);


#doc
ObjCreateAttrRefPlugin - вызвается интерфейсом GetAttrTable для создания ссылок
на таблицы не являющиеся аналитикой.<br>
</brief>
CreateAttrRef_Gal  реализация объектного интерфейса ObjCreateAttrRefPlugin,
чтобы дополнить список ссылок.
#end
ObjInterface ObjCreateAttrRefPlugin;
  #doc
  Добавить таблицу для привязки. Эта процедура вызвается в момент построения списка таблиц.
  AttrRef - ссылка на интерфейс GetAttrTable. Используется, для обратной связи.
  #end
  Procedure AddAttrRefTable (AttrRef : ObjGetAttrTable);

  #doc
  Реализует интерфейс выбора из таблицы.
  #end
  Function PickValueRef (_coTable: word; _cAttrVal: comp): boolean;
end;


#doc
ObjCreateAttrRefPluginEx - вызвается интерфейсом GetAttrTable для создания ссылок
на таблицы не являющиеся аналитикой.<br>
</brief>
CreateAttrRef_Gal  реализация объектного интерфейса ObjCreateAttrRefPluginEx,
чтобы дополнить список ссылок.
#end
ObjInterface ObjCreateAttrRefPluginEx;
  #doc
  Реализует интерфейс выбора из таблицы.
  #end
  Function PickValueRefEx (_coTable: word; var _vString: string; var _vComp: comp): boolean;
end;


//------------------------------------------------------------------------------
#doc
Точка расширения для создания ссылок на таблицы  не являющиеся аналитикой.
#end
ExtensionPoint  epCreateAttrRefTable (AttrRef : ObjGetAttrTable);

//------------------------------------------------------------------------------
#doc
Точка расширения для реализации интерфейса выбора из таблицы. 
Точка расширения должна возвращать true - если интерфейс не найден, в противном случае false  
#end
ExtensionPoint  epPickTableRef (_coTable: word; _cAttrVal: comp);

#end
