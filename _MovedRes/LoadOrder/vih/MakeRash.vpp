//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Логистика
// Создание расходного складского ордера по накладной
//******************************************************************************

#include DOfuns.var

//******************************************************************************
#include mkrfun.vpp     // Функции формирования расходных ордеров
#include mkrfun2.vpp    // Функции формирования расходных ордеров по расходным накладным
#include srpsopr.vpp    // пересчет суммы накладной по ордерам
//******************************************************************************

Function MakeRashOrd(NeedMsg: boolean; pDateOrd: longint): boolean;
var
  wMode  : word; // пакетный или обычный режим
  wParam : word; // дополнительный параметр
{
#ifdef _s2o_
  wMode := 1;

  if (wDPrice <> 0)
    wMode := 2;
#else
  wMode := 0;
#end

  wParam := 0;

#ifdef smetakoladd
  wParam := wParam Or 1;
#end
#ifdef _USE_SERIAL_
  wParam := wParam Or 2;
#end
#ifdef g_l_pr_vpp
  wParam := wParam Or 4;
#end
#ifdef _BoxNeedAuto
  if (bBoxNeedAuto)
    wParam := wParam Or 8;
#end
#ifdef _prihod_
  if (ProtParty = 1)
    wParam := wParam Or 16;
#end
#ifdef __PAKET_VIP__
  wParam := wParam Or 32;
#end

  //--делать UpdateTable только если не используется пакетный режим
  if (wMode = 0)
    if (NeedMsg)
      if NOT UpdateTable
        Exit;

  MakeRashOrd := oMakeOrder.MakeRashOrd (KatSopr.NRec, NeedMsg, pDateOrd, SkPr, wMode, wParam, frm1wed.Handle);

  ReReadRecord(#KatSopr);
}
