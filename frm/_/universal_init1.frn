.begin
  Nom      := 0;
  Sum1Itog := 0;
  Sum2Itog := 0;
  Sum3Itog := 0;
  wForm    := 7;
  bRunSign := not boGetTune('Doc.RunSign');
  CountRow:= 0;
  lPriznakNDS := 0;

  bExistSetial := true;

#ifdef _IN_VAL_DOC_
  Cena_Pr0 := Cena_Pr;
#else
  Cena_Pr0 := Cena_PrR;
#endif
  NumPage := 1;
  RowOnPage_Current :=0 ;
  RowOnPage_First   := 31;//26;
  RowOnPage_Next    := 54;//47;
#ifdef _UNIVERSAL5949_
  RowOnPage_First   := 26;
  RowOnPage_Next    := 53;
  sBarCodeDoc   := Ean13ToEanGnivcTTF(GenerateBarCodeEx(coKatSopr, накладная_нрек));
  if sBarCodeDoc =''
    RowOnPage_First := RowOnPage_First+1;
#endif

  // грузоотправитель
  wStr :=  if (СчФакт_НРек <> 0, if (Признак_МЦ <> 2, if(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 0) <> oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 2),
                                                                                                 oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 2), 8, 0, Дата), 'он же'), '-'),
                        if (Признак_МЦ <> 2, (oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 1, 2)), '-'))
         + if (СчФакт_НРек <> 0, if (Признак_МЦ <> 2, if(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 0) <> oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 2),
                                                                                                 oPrnSoprFun.GetSchFactOrgAddr(СчФакт_НРек, 2, 0), ''), ''),
                        if (Признак_МЦ <> 2, #AdrFields(Грузоотправитель,Грузоотправитель_СТАРАНА_КОД), ''));

  CountRowSpec := GetCountRow(0,wStr,140);
  if CountRowSpec>1
  { RowOnPage_First := RowOnPage_First - (CountRowSpec-1)
  }

  // грузополучатель
  wStr :=  if (СчФакт_НРек <> 0, if (Признак_МЦ <> 2, oPrnSoprFun.GetOrgFullName(oPrnSoprFun.GetSchFactOrgNRec(СчФакт_НРек, 3), 8, 0, Дата), '-'),
                        if (Признак_МЦ <> 2, (oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 1) + oPrnSoprFun.GetOrgFullName(накладная_нрек, 2, 2)), '-'))
         + if (СчФакт_НРек <> 0, if (Признак_МЦ <> 2, oPrnSoprFun.GetSchFactOrgAddr(СчФакт_НРек, 3, 0), ''),
                        if (Признак_МЦ <> 2, #AdrFields(Грузополучатель,Грузополучатель_СТАРАНА_КОД), '')) ;
  CountRowSpec := GetCountRow(0,wStr,140);
  if CountRowSpec>1
  { RowOnPage_First := RowOnPage_First - (CountRowSpec-1)
  }

  //---------------------------
  RowOnPage := RowOnPage_First;
  RowOnPodpis :=22;//24
  vhodNal:=2;
  if vKatSoprMemTTN.Getfirst KatSoprMemTTN where (( comp(накладная_нрек) ==  KatSoprMemTTN.Nrec )) =tsok
     vhodNal := vKatSoprMemTTN.KatSoprMemTTN.vhodNal;
  //ERP-233 >>>>>>>>>>>>>>>>>>>>>>>>
  if not ReadMyDsk(g_ArtClassCode,'GetPersSign7_g_ArtClassCode',true) g_ArtClassCode:=0;;
  if not ReadMyDsk(wGroup,'GetPersSign7_wGroup',true) wGroup:=0;;
  // без этого не пашет - нужно перечитать SpSoprMemTTNGR, RereadRecord; в fcom нет
  // заполнение идет в GetPersSign
  if wGroup<>0
  { MTRetrieve(vSpSoprMemTTN.tnSpSoprMemTTNGR,mfNormal);
    vSpSoprMemTTN._Loop SpSoprMemTTNGR
    { fplog( ' SpSoprMemTTNGR.Nrec '+string(vSpSoprMemTTN.SpSoprMemTTNGR.Nrec));
    }
  }
  //ERP-233 <<<<<<<<<<<<<<<<<<<<<<<<

  bProsTovarColVisible := oPrnSoprFun.GetProsTovarColVisible(накладная_нрек, coKatSopr);
  DATE_OTGR_ISX := oPrnSoprFun.GetFieldValue(накладная_нрек, coKatSopr,'DATE_OTGR_ISX');
  WidthSpecName := if(bProsTovarColVisible,17,24);
  boRTF_FoterDIV    := boGetTune('Doc.SD.Prn.UPD.RTF_FoterDIV'); //ERP-8518
  bExistSetial := (vKatSoprMemTTN.Getfirst Fr_VolumeSort  = tsok);
end.
