//------------------------------------------------------------------------------
//                                                      (c) Корпорация ГАЛАКТИКА
//------------------------------------------------------------------------------
// Галактика 5.8
// Обьектный интерфес работы с таблицей PickBuh
//------------------------------------------------------------------------------

!interface
#ifndef _PickBuh_vih_Included
#define _PickBuh_vih_Included

#ifdef ComponentVersion
#Component "F_BuhRep"
#end

#ifdef Gal8_1
!-------------------------------------------------------------------------------
Table struct PickBuh
(
   KodTable : word      "таблица"
  ,PickRec  : tNRec     "номер элемента в списке"
  ,PickKod  : String [21]   "код или NRec элемента"
  ,Schet    : String [21]   "бухг.счет"
  ,SubKau   : String [21]   "субсчет/КАУ"
  ,Name     : tName     "имя фильтра"
  ,Pick     : integer   "порядок выбора"
  ,PickKol  : double    "количество"
)
with index
(
   PickBuhRec = KodTable + PickRec
  ,PickBuhKod = KodTable + PickKod
  ,PickBuhSch = KodTable + Schet + PickKod
  ,PickBuhPck = KodTable + Pick
);
!-------------------------------------------------------------------------------
#end

!-------------------------------------------------------------------------------
#doc
Серфисные функции для работы с таблицей PickBuh
#end
ObjInterface ObjPickBuh;
!-------------------------------------------------------------------------------
  #doc
  Подсчет количесва записей по коду таблицы
  #end
  function GetCountItem      (wTab : word)                  : word;
!-------------------------------------------------------------------------------
  #doc
  Существуют ли записи по коду таблицы
  #end
  function FoundInPick       (wTab : word)                  : boolean;
!-------------------------------------------------------------------------------
  #doc
  Вернуть PickRec первой найденной по коду таблицы записи
  #end
  function FoundInPick_GetRec
                             (wTab : word)                  : comp;
!-------------------------------------------------------------------------------
  #doc
  Вернуть PickKod первой найденной по коду таблицы записи
  #end
  function FoundInPick_GetKod
                             (wTab : word)                  : String [21];
!-------------------------------------------------------------------------------
  #doc
  Вернуть Schet первой найденной по коду таблицы записи
  #end
  function FoundInPick_GetSchet(wTab : word)                  : String [21];
!-------------------------------------------------------------------------------
  #doc
  Существуют ли запись по коду таблицы и PickKod
  #end
  function FoundInPickByKod  (wTab : word; sKod : String [21])  : boolean;
!-------------------------------------------------------------------------------
  #doc
  Существуют ли запись по коду таблицы и PickRec
  #end
  function FoundInPickByRec  (wTab : word; cRec : comp)     : boolean;
!-------------------------------------------------------------------------------
  // приходится искать _Loop - ом, надо это дело как то грохать
  #doc
  Есть ли субсчет
  #end
  function FoundSubSch       (Sch : String [21]; Sub : String [21]) : boolean;
!-------------------------------------------------------------------------------
  #doc
  Найти первый попавшийся субсчет и вернуть его и его счет
  #end
  function FoundFirstSub     (var Sch : String [21];
                              var Sub : String [21])            : boolean;
!-------------------------------------------------------------------------------
  #doc
  Есть ли в PickBuh субсчета указанного счета
  #end
  function FoundSubForSchet  (Sch : String [21])                : boolean;
!-------------------------------------------------------------------------------
  #doc
  Очистка таблицы
  #end
  function DeletePickBuh                                    : boolean;
!-------------------------------------------------------------------------------
  #doc
  Удаление по коду таблицы
  #end
  function DeleteItem        (wTbl : word)                  : boolean;
!-------------------------------------------------------------------------------
  #doc
  Удаление по коду таблицы и PickRec
  #end
  function DeleteItemByRec   (wTab : word; cRec : comp)     : boolean;
!-------------------------------------------------------------------------------
  #doc
  Удаление по коду таблицы и Счету
  #end
  function DeleteItemBySchet (wTab : word; Sch : String [21])   : boolean;
!-------------------------------------------------------------------------------
  #doc
  Скопировать записи и вернуть количество
  #end
  function CopyItem          (wOld, wNew : word)            : word;
!-------------------------------------------------------------------------------
  #doc
  Перенести записи на новый код таблицы и вернуть количество
  #end
  function MoveItem          (wOld, wNew : word)            : word;
!-------------------------------------------------------------------------------
  #doc
  Вставить запись (все поля)
  #end
  function InsertFullRecord  (wTbl : word;
                              cRec : comp;
                              sKod, sSch, sSub, sName : string;
                              iPick : integer;
                              dPick : double)               : boolean;
!-------------------------------------------------------------------------------
  #doc
  Вставить запись (все поля для аналитики)
  #end
  function InsertAnRecord    (wTbl : word;
                              cRec : comp;
                              sKod, sName : string;
                              iPick : integer)              : boolean;
!-------------------------------------------------------------------------------
end;
!-------------------------------------------------------------------------------
VipInterface PickBuh implements ObjPickBuh; //#Licensed_Free;
!-------------------------------------------------------------------------------
#end // _PickBuh_vih_Included
