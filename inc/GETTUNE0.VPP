// настройка пользователя для вызова cmInit для Interface
// определяет в глобальные переменные (см. var_vips.vpp)
function GetUserTuneParam : boolean;
var
  ddOt : date;
{
  GetUserTuneParam := false;
  // Должна быть дата отчетного периода
  ddOt := dGetTune('Dat_M_Ot');
  if (longint(ddOt) = 0) {
    message('Не установлен отчетный период!'#13 +
            'Проведите настройку!',CancelButton);
    Exit;
  }
  CurListGd  := coGetTune('Fin.User.cListGD');
  CurDescr   := sGetTune('User.Descr');
  CurDesGr   := sGetTune('User.DesGr');
  CurVisible := wGetTune('Doc.Visible');
  // План счетов сначала пользователя, а потом - общесистемный
  myPlansNo  := coGetTune('Fin.User.cPlansSch');
  if (myPlansNo = 0)
    myPlansNo := coGetTune('Konsolid.cPlansSch');
  if (myPlansNo = 0) {
    message('Установите текущий план счетов в настройке системы!',CancelButton);
    Exit;
  }
  // И проверяем чтобы существовал план счетов
  else if (GetFirst PlansSch where ((myPlansNo == PlansSch.NRec)) <> tsOk) {
    message('Утеряна настройка планов счетов!'#13 +
            'Проведите настройку!'#13 +
            'Установите текущий план счетов!',CancelButton);
    Exit;
  }
  // А теперь обнулим все остальные переменные из var_vips.vpp
  myValNo          := 0;
  myDate           := 0;
  myRec            := 0;
  OkUserDate       := false;
  OkInitKau        := false;
  ModOborot        := false;
  dFormNa          := 0;
  BegDate          := 0;
  EndDate          := 0;
  TecNameFilter    := '';
  IntDatFil        := 0;
  CurProcProtect   := 0;
  AllPick          := 0;
  // И результат вернем
  GetUserTuneParam := true;
}

#include inc\gettune3.vpp
