Procedure FillPS1_VetisAPI_GetStockEntryVersionListRequest(_ExcelFileOut, _OleGenerateGUID: string; _StockGUID : string);
{
  MyWriteLN('Get-ChildItem -Path $PSScriptRoot -Include @("*.ps1","*.log", "*.xls*") -Recurse | Where-Object -Property CreationTime -lt (Get-Date).AddDays(-8) | Remove-Item -Force -ErrorAction SilentlyContinue');
  MyWriteLN('$circuitserviceID="'+coCircuit_serviceID+'"                              ');
  MyWriteLN('$circuitendpointUrl="'+coCircuit_endpointUrlGetStockEntryVersionListRequest+'"                          ');
  MyWriteLN('$circuitlogin="'+coCircuit_login+'"                                      ');
  MyWriteLN('$circuitpassword="'+coCircuit_password+'"                                ');
  MyWriteLN('$circuitapiKey="'+coCircuit_apiKey+'"                            ');
  MyWriteLN('$circuitissureId="'+coCircuit_issureId+'"                                ');
  MyWriteLN('$circuitsysLogin="'+coCircuit_sysLogin+'"                                 ');
  MyWriteLN('$circuitenterpriseGuid="'+coCircuit_enterpriseGuid+'"                     ');
  MyWriteLN('$circuitbusinessEntityGuid ="'+coCircuit_businessEntityGuid+'"            ');
  MyWriteLN('                                                                           ');
  MyWriteLN('$circuitCountTry           = '+coCircuit_CountTry+'                        ');
  MyWriteLN('$circuitPause              = '+coCircuit_Pause+'                           ');
  MyWriteLN('$fileLog =    "'+_MylogFile+'" ');
  MyWriteLN('$ReportPath = "'+_ExcelFileOut +'"                                         ');
  MyWriteLN('[String]$GlobError                                                                   ');
  MyWriteLN('$GlobError = ""                                                                      ');
  MyWriteLN('$RQST_GUID = "'+_OleGenerateGUID+'"                                                                                     ');
  MyWriteLN('$conStrinGal  = '''+GetConnString+'''');
  MyWriteLN('$StockGUID = "'+_StockGUID+'"');
  MyWriteLN('                                    ');
  MyWriteLN('function Invoke-DatabaseQuery {         ');
  MyWriteLN('        [CmdletBinding()]               ');
  MyWriteLN('        param (                           ');
  MyWriteLN('                [string]$connectionString,');
  MyWriteLN('                [string]$query,           ');
  MyWriteLN('                [switch]$isSQLServer      ');
  MyWriteLN('        )                                 ');
  MyWriteLN('        if ($isSQLServer) {               ');
  MyWriteLN('                Write-Verbose ''in SQL Server mode''  ');
  MyWriteLN('                $connection = New-Object -TypeName System.Data.SqlClient.SqlConnection');
  MyWriteLN('        } else {                                                                      ');
  MyWriteLN('                Write-Verbose ''in OleDB mode''                                       ');
  MyWriteLN('                $connection = New-Object -TypeName System.Data.OleDb.OleDbConnection  ');
  MyWriteLN('        }                                                                             ');
  MyWriteLN('        $connection.ConnectionString = $connectionString                              ');
  MyWriteLN('        $command = $connection.CreateCommand()                                        ');
  MyWriteLN('        $command.CommandText = $query                                                 ');
  MyWriteLN('        $connection.Open()                                                            ');
  MyWriteLN('        $command.ExecuteNonQuery()                                                    ');
  MyWriteLN('        $connection.close()                                                           ');
  MyWriteLN('}                                                                                     ');
  MyWriteLN('Function GetDataFromWeb([xml]$fnXML, [string]$URL)                                    ');
  MyWriteLN('{                                                                                     ');
  MyWriteLN('                                                                                      ');
  MyWriteLN('$headers = @{}                                                                        ');
  MyWriteLN('$headers.add("SOAPAction","GetResponse")                                              ');
  MyWriteLN('$headers.add("Accept","text/xml")                                                     ');
  MyWriteLN('                                                                                      ');
  MyWriteLN('$credentials = New-Object System.Management.Automation.PSCredential -ArgumentList @($circuitlogin,(ConvertTo-SecureString -String $circuitpassword -AsPlainText -Force)) ');
  MyWriteLN('   try                                                                                                                                                                   ');
  MyWriteLN('    {                                                                                                                                                                    ');
  MyWriteLN('     Invoke-WebRequest -URI $URL -Headers $headers -Method Post -Body $fnXML -ContentType ''text/xml;charset="utf-8"'' -Credential $credentials -UseBasicParsing         ');
  MyWriteLN('    }                                                                                                                                                                    ');
  MyWriteLN('    catch                                                                                                                                                                ');
  MyWriteLN('    {                                                                                                                                                                    ');
  MyWriteLN('      $GlobError = $error[0]                                                                                                                                             ');
  MyWriteLN('      $null                                                                                                                                                              ');
  MyWriteLN('    }                                                                                                                                                                    ');
  MyWriteLN('}                                                                                                                                                                        ');
  MyWriteLN('Function GetResponse()                                                                                                                                                   ');
  MyWriteLN('{                                                                                                                                                                        ');
  MyWriteLN(' $template = @''                                                                                                                                                          ');
  MyWriteLN('<SOAP-ENV:Envelope                                                                                                                                                       ');
  MyWriteLN('             xmlns:dt="http://api.vetrf.ru/schema/cdm/dictionary/v2"                                                                                                     ');
  MyWriteLN('             xmlns:bs="http://api.vetrf.ru/schema/cdm/base"                                                                                                              ');
  MyWriteLN('             xmlns:merc="http://api.vetrf.ru/schema/cdm/mercury/g2b/applications/v2"                                                                                     ');
  MyWriteLN('             xmlns:apldef="http://api.vetrf.ru/schema/cdm/application/ws-definitions"                                                                                    ');
  MyWriteLN('             xmlns:apl="http://api.vetrf.ru/schema/cdm/application"                                                                                                      ');
  MyWriteLN('             xmlns:vd="http://api.vetrf.ru/schema/cdm/mercury/vet-document/v2"                                                                                           ');
  MyWriteLN('             xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">                                                                                                 ');
  MyWriteLN('  <SOAP-ENV:Header/>                                                                                                                                                     ');
  MyWriteLN('  <SOAP-ENV:Body>                                                                                                                                                        ');
  MyWriteLN('    <apldef:submitApplicationRequest>                                                                                                                                    ');
  MyWriteLN('      <apldef:apiKey>{0}</apldef:apiKey>                                                                                                                                 ');
  MyWriteLN('      <apl:application>                                                                                                                                                  ');
  MyWriteLN('        <apl:serviceId>{1}</apl:serviceId>                                                                                                                               ');
  MyWriteLN('        <apl:issuerId>{2}</apl:issuerId>                                                                                                                                 ');
  MyWriteLN('        <apl:issueDate>2019-08-19T17:24:45+03:00</apl:issueDate>                                                                                                         ');
  MyWriteLN('        <apl:data>                                                                                                                                                       ');
  MyWriteLN('          <merc:getStockEntryVersionListRequest>                                                                                                                         ');
  MyWriteLN('            <merc:localTransactionId>a110f03</merc:localTransactionId>                                                                                                   ');
  MyWriteLN('            <merc:initiator>                                                                                                                                             ');
  MyWriteLN('             <vd:login>{3}</vd:login>                                                                                                                                    ');
  MyWriteLN('            </merc:initiator>                                                                                                                                            ');
  MyWriteLN('                <bs:listOptions>                                                                                                                                         ');
  MyWriteLN('              <bs:count>1000</bs:count>                                                                                                                                  ');
  MyWriteLN('              <bs:offset>0</bs:offset>                                                                                                                                   ');
  MyWriteLN('            </bs:listOptions>                                                                                                                                            ');
  MyWriteLN('             <bs:guid>{4}</bs:guid>                                                                                                                                      ');
  MyWriteLN('             <dt:enterpriseGuid>{5}</dt:enterpriseGuid>                                                                                                                  ');
  MyWriteLN('          </merc:getStockEntryVersionListRequest>                                                                                                                        ');
  MyWriteLN('        </apl:data>                                                                                                                                                      ');
  MyWriteLN('      </apl:application>                                                                                                                                                 ');
  MyWriteLN('    </apldef:submitApplicationRequest>                                                                                                                                   ');
  MyWriteLN('  </SOAP-ENV:Body>                                                                                                                                                       ');
  MyWriteLN('</SOAP-ENV:Envelope>                                                                                                                                                     ');
  MyWriteLN('''@                                                                                                                                                                       ');
  MyWriteLN('                                                                                                                                                                         ');
  MyWriteLN('#            webRequest.Credentials = credentials;                                                                                                                       ');
  MyWriteLN('                                                                                                                                                                         ');
  MyWriteLN('$fnc_RqstBody = $template -f $circuitapiKey, $circuitserviceID, $circuitissureId, $circuitsysLogin, $StockGUID, $circuitenterpriseGuid                                   ');
  MyWriteLN('                                                                                                                                                                         ');
  MyWriteLN('                                                                                                                                                                         ');
  MyWriteLN('[xml] $XmlPrepare = $fnc_RqstBody                                                                                                                                        ');
  MyWriteLN('                                                                                                                                                                         ');
  MyWriteLN('$response = GetDataFromWeb -fnXML $XmlPrepare -URL $circuitendpointUrl                                                                                                   ');
  MyWriteLN('                                                                                                                                                                         ');
  MyWriteLN('    If ( ($response.StatusCode -eq 200) -and ($response -ne $null))                                                                                                      ');
  MyWriteLN('    {                                                                                                                                                                    ');
  MyWriteLN('     [xml] $XmlResponse = $response.content                                                                                                                              ');
  MyWriteLN('     #write-host $response.content                                                                                                                                       ');
  MyWriteLN('     $XmlResponse.GetElementsByTagName(''applicationId'').Item(0).FirstChild.data                                                                                          ');
  MyWriteLN('    }                                                                                                                                                                    ');
  MyWriteLN('    else                                                                                   ');
  MyWriteLN('    {                                                                                      ');
  MyWriteLN('     $null                                                                                 ');
  MyWriteLN('    }                                                                                      ');
  MyWriteLN('}                                                                                          ');
  MyWriteLN('                                                                                           ');
  MyWriteLN('                                                                                           ');
  MyWriteLN('Function RecieveApplRqst([string]$requestAplId)                                            ');
  MyWriteLN('{                                                                                          ');
  MyWriteLN('$template=@''                                                                               ');
  MyWriteLN('<SOAP-ENV:Envelope                                                                         ');
  MyWriteLN('                    xmlns:dt="http://api.vetrf.ru/schema/cdm/dictionary/v2"                ');
  MyWriteLN('                    xmlns:bs="http://api.vetrf.ru/schema/cdm/base"                           ');
  MyWriteLN('                    xmlns:merc="http://api.vetrf.ru/schema/cdm/mercury/g2b/applications/v2"  ');
  MyWriteLN('                    xmlns:apldef="http://api.vetrf.ru/schema/cdm/application/ws-definitions" ');
  MyWriteLN('                    xmlns:apl="http://api.vetrf.ru/schema/cdm/application"                   ');
  MyWriteLN('                    xmlns:vd="http://api.vetrf.ru/schema/cdm/mercury/vet-document/v2"        ');
  MyWriteLN('                    xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"               ');
  MyWriteLN('                    xmlns:ws="http://api.vetrf.ru/schema/cdm/application/ws-definitions">    ');
  MyWriteLN('                <SOAP-ENV:Header/>                                                           ');
  MyWriteLN('                <SOAP-ENV:Body>                                                              ');
  MyWriteLN('                    <ws:receiveApplicationResultRequest>                                     ');
  MyWriteLN('                        <ws:apiKey>{0}</ws:apiKey>                                           ');
  MyWriteLN('                        <ws:issuerId>{1}</ws:issuerId>                                       ');
  MyWriteLN('                        <ws:applicationId>{2}</ws:applicationId>                             ');
  MyWriteLN('                    </ws:receiveApplicationResultRequest>                                    ');
  MyWriteLN('                </SOAP-ENV:Body>                                                             ');
  MyWriteLN('</SOAP-ENV:Envelope>                                                                         ');
  MyWriteLN('''@                                                                                          ');
  MyWriteLN('#            webRequest.Credentials = credentials;                                           ');
  MyWriteLN('                                                                                             ');
  MyWriteLN('$fnc_RqstBody = $template -f $circuitapiKey, $circuitissureId, $requestAplId                 ');
  MyWriteLN('  $isContinue = $true                                                                        ');
  MyWriteLN('  $CountTRy = 0                                                                              ');
  MyWriteLN('[xml] $XmlPrepare = $fnc_RqstBody                                                            ');
  MyWriteLN('[xml] $result = $null                                                                        ');
  MyWriteLN('                                                                                             ');
  MyWriteLN('                                                                                             ');
  MyWriteLN('  while ($isContinue -eq $true)                                                              ');
  MyWriteLN('  {                                                                                          ');
  MyWriteLN('    Wait-Event -Timeout $circuitPause                                                        ');
  MyWriteLN('   $CountTRy = $CountTRy + 1                                                                 ');
  MyWriteLN('   $response = GetDataFromWeb -fnXML $XmlPrepare -URL $circuitendpointUrl                    ');
  MyWriteLN('   [string] $currentStatus = ""                                                              ');
  MyWriteLN('    If ( ($response.StatusCode -eq 200) -and ($response -ne $null))                          ');
  MyWriteLN('    {                                                                                         ');
  MyWriteLN('     [xml] $XmlResponse = $response.content                                                   ');
  MyWriteLN('     $currentStatus = $XmlResponse.GetElementsByTagName(''status'').Item(0).FirstChild.data   ');
  MyWriteLN('     if ($currentStatus -eq ''COMPLETED'')                                                    ');
  MyWriteLN('      {                                                                                       ');
  MyWriteLN('       $isContinue = $false                                                                   ');
  MyWriteLN('       $result = $XmlResponse                                                                 ');
  MyWriteLN('       # write-host $response.content                                                         ');
  MyWriteLN('      }                                                                                       ');
  MyWriteLN('     if ($currentStatus -eq "")                                                               ');
  MyWriteLN('     {                                                                                        ');
  MyWriteLN('      $isContinue = $false                                                                    ');
  MyWriteLN('      $result  = $null                                                                        ');
  MyWriteLN('     }                                                                                        ');
  MyWriteLN('    }                                                                                         ');
  MyWriteLN('    else                                                                                      ');
  MyWriteLN('    {                                                                                         ');
  MyWriteLN('     $isContinue = $false                                                                     ');
  MyWriteLN('     $result  = $null                                                                         ');
  MyWriteLN('    }                                                                                         ');
  MyWriteLN('    #write-host "try number $CountTRy of $circuitCountTry | Curent state: $currentStatus"     ');
  MyWriteLN('    write-host "Запрос стока. Прослушивание ответа API. Запрос $CountTRy из $circuitCountTry. Получен ответ: $currentStatus"  -ForegroundColor Green');
  MyWriteLN('Add-Content -Path $fileLog -Value $($(Get-Date).ToString("yyyy-MM-dd HH:mm:ss") + " Запрос стока. Прослушивание ответа API. Запрос $CountTRy из $circuitCountTry. Получен ответ: $currentStatus") -Encoding Oem ');
  MyWriteLN('    if ($circuitCountTry -lt $CountTRy )                                      ');
  MyWriteLN('     {                                                                        ');
  MyWriteLN('      $isContinue = $false                                                    ');
  MyWriteLN('     }                                                                        ');
  MyWriteLN('  }                                                                           ');
  MyWriteLN(' $result                                                                      ');
  MyWriteLN('}                                                                             ');
  MyWriteLN('[xml]$stockEntryElementList = $null                                           ');
  MyWriteLN(' write-host "Запрос стока. Отправка запроса"  -ForegroundColor Green          ');
  MyWriteLN('    Add-Content -Path $fileLog -Value $($(Get-Date).ToString("yyyy-MM-dd HH:mm:ss") + " Запрос стока. Отправка запроса") -Encoding Oem');
  MyWriteLN('$requestAplId = GetResponse                                                        ');
  MyWriteLN('if ($GlobError -eq '''')                                                             ');
  MyWriteLN('{                                                                                  ');
  MyWriteLN(' write-host "Запрос стока. Прослушивание ответа API"  -ForegroundColor Green       ');
  MyWriteLN('    Add-Content -Path $fileLog -Value $($(Get-Date).ToString("yyyy-MM-dd HH:mm:ss") + " Запрос стока. Прослушивание ответа API") -Encoding Oem');
  MyWriteLN(' $stockEntryElementList = RecieveApplRqst($requestAplId)         ');
  MyWriteLN('                                                                 ');
  MyWriteLN('}                                                                ');
  MyWriteLN('else                                                             ');
  MyWriteLN('{                                                                ');
  MyWriteLN(' $GlobError                                                      ');
  MyWriteLN('}                                                                ');
  MyWriteLN('                                                                 ');
  MyWriteLN('if ($stockEntryElementList -ne $null)                            ');
  MyWriteLN('{                                                                ');
  MyWriteLN('[System.Collections.ArrayList] $FinalReport = @();               ');
  MyWriteLN('    #$stockEntryElementList.save("C:\Users\lapus\OneDrive\Desktop\_WORK\stockEntryElementList.xml")');
  MyWriteLN('                                                                                                   ');
  MyWriteLN('    #$stockEntryElementList.GetElementsByTagName(''application'')                                    ');
  MyWriteLN('    #$stockEntryElementList.GetElementsByTagName(''result'')                                         ');
  MyWriteLN('   write-host "Запрос стока. Разбор XML ответа"  -ForegroundColor Green                            ');
  MyWriteLN('    Add-Content -Path $fileLog -Value $($(Get-Date).ToString("yyyy-MM-dd HH:mm:ss") + " Запрос стока. Разбор XML ответа") -Encoding Oem');
  MyWriteLN('                                                                                                                                       ');
  MyWriteLN('                                                                                                                                       ');
  MyWriteLN('    # пошлда спецификация                                                                                                              ');
  MyWriteLN('    foreach($stockEntry in $stockEntryElementList.Envelope.Body.receiveApplicationResultResponse.application.result.getStockEntryVersionListResponse.stockEntryList.stockEntry)');
  MyWriteLN('    {                                                                                                        ');
  MyWriteLN('                                                                                                             ');
  MyWriteLN('    $ExistPackage = $null                                                                                    ');
  MyWriteLN('       $item = New-Object PSObject                                                                           ');

  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "uuid" -Value $stockEntry.uuid.ToString()                       ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "status" -Value $stockEntry.status.ToString()                   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "createDate" -Value $stockEntry.createDate.ToString()           ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "updateDate" -Value $stockEntry.updateDate.ToString()           ');
  MyWriteLN('       if ($stockEntry.next -ne $null)                                                                             ');
  MyWriteLN('        {                                                                                                             ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "next" -Value $stockEntry.next.ToString()                        ');
  MyWriteLN('        }                                                                                                             ');
  MyWriteLN('        else                                                                                                          ');
  MyWriteLN('         {                                                                                                            ');
  MyWriteLN('          $item | Add-Member -type NoteProperty -Name "next" -Value ""                                                ');
  MyWriteLN('         }                                                                                                            ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.productType" -value $stockEntry.batch.productType           ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.product.uuid" -value $stockEntry.batch.product.uuid         ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.product.guid" -value $stockEntry.batch.product.guid         ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.subProduct.uuid" -value $stockEntry.batch.subProduct.uuid   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.subProduct.guid" -value $stockEntry.batch.subProduct.guid   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.productItem.name" -value $stockEntry.batch.productItem.name ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.volume" -value $stockEntry.batch.volume                     ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.unit.uuid" -value $stockEntry.batch.unit.uuid               ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.unit.guid" -value $stockEntry.batch.unit.guid               ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.dateOfProduction.firstDate.year" -value $stockEntry.batch.dateOfProduction.firstDate.year   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.dateOfProduction.firstDate.month" -value $stockEntry.batch.dateOfProduction.firstDate.month ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.dateOfProduction.firstDate.day" -value $stockEntry.batch.dateOfProduction.firstDate.day     ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.expiryDate.firstDate.year" -value $stockEntry.batch.expiryDate.firstDate.year               ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.expiryDate.firstDate.month" -value $stockEntry.batch.expiryDate.firstDate.month             ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.expiryDate.firstDate.day" -value $stockEntry.batch.expiryDate.firstDate.day                 ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.batchID" -value $stockEntry.batch.batchID                                                   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.perishable" -value $stockEntry.batch.perishable                                             ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.origin.productItem.name" -value $stockEntry.batch.origin.productItem.name                   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.origin.country.uuid" -value $stockEntry.batch.origin.country.uuid                           ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.origin.country.guid" -value $stockEntry.batch.origin.country.guid                           ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.origin.producer.enterprise.uuid" -value $stockEntry.batch.origin.producer.enterprise.uuid   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.origin.producer.enterprise.guid" -value $stockEntry.batch.origin.producer.enterprise.guid   ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.origin.producer.role" -value $stockEntry.batch.origin.producer.role                         ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.lowGradeCargo" -value $stockEntry.batch.lowGradeCargo                                       ');

  MyWriteLN('        $ExistTN = $False                                                                                         ');
  MyWriteLN('        $ExistCT = $False                                                                                         ');
  MyWriteLN('      foreach( $package in $stockEntry.batch.packageList.package)                                                 ');
  MyWriteLN('      {                                                                                                           ');
  MyWriteLN('        [string]$globalID = $package.packingType.globalID.ToString()                                              ');
  MyWriteLN('        if ($globalID -eq ''TN'')                                                                                 ');
  MyWriteLN('        {                                                                                                         ');
  MyWriteLN('         $ExistTN = $true                                                                                         ');
  MyWriteLN('        }                                                                                                         ');
  MyWriteLN('        if ($globalID -eq ''CT'')                                                                                 ');
  MyWriteLN('        {                                                                                                         ');
  MyWriteLN('         $ExistCT = $true                                                                                         ');
  MyWriteLN('        }                                                                                                         ');
  MyWriteLN('        if ( ($ExistTN -eq $true) -or  ($ExistCT -eq $true))                                                      ');
  MyWriteLN('        {                                                                                                         ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "level.$globalID" -value $package.level                      ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "uuid.$globalID" -value $package.packingType.uuid            ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "guid.$globalID" -value $package.packingType.guid            ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "globalID.$globalID" -value $package.packingType.globalID    ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "name.$globalID" -value $package.packingType.name            ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "quantity.$globalID" -value $package.quantity                ');
  MyWriteLN('        }                                                                                                         ');
  MyWriteLN('      }                                                                                                           ');
  MyWriteLN('      if( $ExistTN -eq $False)                                                                                    ');
  MyWriteLN('      {                                                                                                           ');
  MyWriteLN('         $globalID = ''TN''                                                                                       ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "level.$globalID" -value ""                                  ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "uuid.$globalID" -value ""                                   ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "guid.$globalID" -value ""                                   ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "globalID.$globalID" -value ""                               ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "name.$globalID" -value ""                                   ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "quantity.$globalID" -value ""                               ');
  MyWriteLN('      }                                                                                                           ');
  MyWriteLN('      if($ExistCT -eq $False)                                                                                     ');
  MyWriteLN('      {                                                                                                           ');
  MyWriteLN('         $globalID = ''CT''                                                                                       ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "level.$globalID" -value ""                                  ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "uuid.$globalID" -value ""                                   ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "guid.$globalID" -value ""                                   ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "globalID.$globalID" -value ""                               ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "name.$globalID" -value ""                                   ');
  MyWriteLN('         $item | Add-Member -type NoteProperty -Name "quantity.$globalID" -value ""                               ');
  MyWriteLN('      }                                                                                                           ');

  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.owner.uuid" -value $stockEntry.batch.owner.uuid                                             ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "batch.owner.guid" -value $stockEntry.batch.owner.guid                                             ');
  MyWriteLN('       $item | Add-Member -type NoteProperty -Name "vetEventList.laboratoryResearch" -value $stockEntry.vetEventList.laboratoryResearch               ');
  MyWriteLN('       $FinalReport +=,$item                                                                                                                          ');
  MyWriteLN('                                                                                                                                                      ');
  MyWriteLN('    write-host $stockEntry.Batch.ProductItem.Name -ForegroundColor Cyan                                                                               ');
  MyWriteLN('    Add-Content -Path $fileLog -Value $($(Get-Date).ToString("yyyy-MM-dd HH:mm:ss") + " "+ $stockEntry.Batch.ProductItem.Name) -Encoding Oem          ');
  MyWriteLN('  }                                                                                                                                                   ');
  MyWriteLN('                                                                                                                                                      ');
  MyWriteLN(' write-host "Запрос стока. Выгрузка в EXCEL" -ForegroundColor Green                                                                                   ');
  MyWriteLN(' $ReportPath = $ReportPath                                                                                                                            ');
  MyWriteLN(' $FinalReport | Export-Excel -Path $ReportPath -AutoSize -WorksheetName "GetStockList"                                                                ');
  MyWriteLN('                                                                                                                                                      ');
  MyWriteLN('}                                                                                                                                                     ');

}
Function GetRequestToAPIVetis_GetStockEntryVersionListRequest(_fnSTOCKGUID : string) : boolean;
{
  _rqstError := '';
   #BodyProcedureGetRqst(GetStockEntryVersionListRequest,_fnSTOCKGUID)

  xlCreateExcelWithTemplate(_ExcelFileOut,true);
  xlKillExcel;
}
